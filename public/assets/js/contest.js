var selectMenu=$("#platformFilter"),contestList=$("#fetchedList"),sortTime=!0,sortDate=!0;const allContest=[];var current="all";function sortByTime(){contestList.children().sort(function(t,e){return sortTime?parseInt(t.dataset.time)-parseInt(e.dataset.time):parseInt(e.dataset.time)-parseInt(t.dataset.time)}).appendTo(contestList),sortTime=!sortTime}function sortByDate(){contestList.children().sort(function(t,e){return sortDate?e.dataset.date.localeCompare(t.dataset.date):t.dataset.date.localeCompare(e.dataset.date)}).appendTo(contestList),sortDate=!sortDate}function formatCalendarUrl(t){return t=(t=t.slice(0,60)+t.slice(61,63)+t.slice(64,69)+t.slice(70,72)+t.slice(73,75)+t.slice(79)).slice(0,77)+t.slice(78,80)+t.slice(81,86)+t.slice(87,89)+t.slice(90,92)+t.slice(96),text_index=t.indexOf("&text=")+6,location_index=t.indexOf("&location="),name=t.slice(text_index,location_index),name=name.replace("#","%23"),name=name.replace("&","%26"),name=name.replace("+","%2B"),name=name.replace("?","%3F"),t=t.slice(0,text_index)+name+t.slice(location_index)}function localTimeFromUtc(t){if("-"===t)return"-";var e=new Date(t);return DateFormat.format.date(e,"dd MMM yyyy HH:mm")}function durationToText(t){return"-"===t?"-":(seconds=parseInt(t),days=Math.floor(seconds/86400),days_s="days",1==days&&(days_s="day"),seconds%=86400,hours=Math.floor(seconds/3600),hours=("0"+hours).slice(-2),seconds%=3600,minutes=Math.floor(seconds/60),minutes=("0"+minutes).slice(-2),days>0?`${days} ${days_s} and ${hours}:${minutes}`:`${hours}:${minutes}`)}$.get("https://kontests.net/api/v1/sites",function(t){let e=t;for(let t of e)selectMenu.append('<option value="'+t[0]+'">'+t[0]+"</option>")}),$.get("https://kontests.net/api/v1/all",function(t){let e=t;for(let t of e)allContest.push(t);allContest.sort(function(t,e){return t.start_time.localeCompare(e.start_time)}),allContest.forEach(t=>{add_to_calendar="https://calendar.google.com/event?action=TEMPLATE&dates="+t.start_time+"/"+t.end_time+"&text="+t.name+"&location="+t.url,add_to_calendar=formatCalendarUrl(add_to_calendar),contestList.append(`<div class="item animate__animated animate__fadeInUp" data-time="${t.duration}" data-date="${t.start_time}">\n        <div style="width:8%;box-sizing: border-box;" id="userlistdp">\n        <a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page"><img src="/images/contestIcons/${t.site.replace(" ","_").replace("::","_")}.png"></img></a>\n        </div>\n        <div style="width:35%;text-align: left;" class="question"><a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page">${t.name}</a></div>\n        <div style="width:20%">${localTimeFromUtc(t.start_time)}</div>\n        <div style="width:18%">${durationToText(t.duration)}</div>\n        ${"CODING"===t.status?'<div style="width:13%;background-color:#389810;padding:0.4rem 0rem;border-radius:10px;">Active</div>':"Yes"===t.in_24_hours?'<div style="width:13%;background-color:#1570FF;padding:0.4rem 0rem;border-radius:10px;">In Next 24Hrs</div>':'<div style="width:13%;background-color:#F97600;padding:0.4rem 0rem;border-radius:10px;">Coming up</div>'}\n        ${"BEFORE"===t.status?`<div style="width:6%;"><a style="color:#6BAAED;" data-toggle="tooltip" data-placement="top" title="Add to Calendar" href="${add_to_calendar}" target="_blank"><i class="fa-solid fa-calendar-plus"></i></a></div>`:""}\n        </div>`)})}),$("#platformFilter").on("change",function(){if(current!==this.value)return sortTime=!0,sortDate=!0,current=this.value,contestList.empty(),"all"===current?void allContest.forEach(t=>{add_to_calendar="https://calendar.google.com/event?action=TEMPLATE&dates="+t.start_time+"/"+t.end_time+"&text="+t.name+"&location="+t.url,add_to_calendar=formatCalendarUrl(add_to_calendar),contestList.append(`<div class="item animate__animated animate__fadeInUp" data-time="${t.duration}" data-date="${t.start_time}">\n                <div style="width:8%;box-sizing: border-box;" id="userlistdp">\n                <a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page"><img src="/images/contestIcons/${t.site.replace(" ","_").replace("::","_")}.png"></img></a>\n                </div>\n                <div style="width:35%;text-align: left;" class="question"><a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page">${t.name}</a></div>\n                <div style="width:20%">${localTimeFromUtc(t.start_time)}</div>\n                <div style="width:18%">${durationToText(t.duration)}</div>\n                ${"CODING"===t.status?'<div style="width:13%;background-color:#389810;padding:0.4rem 0rem;border-radius:10px;">Active</div>':"Yes"===t.in_24_hours?'<div style="width:13%;background-color:#1570FF;padding:0.4rem 0rem;border-radius:10px;">In Next 24Hrs</div>':'<div style="width:13%;background-color:#F97600;padding:0.4rem 0rem;border-radius:10px;">Coming up</div>'}\n                ${"BEFORE"===t.status?`<div style="width:6%;"><a style="color:#6BAAED;" data-toggle="tooltip" data-placement="top" title="Add to Calendar" href="${add_to_calendar}" target="_blank"><i class="fa-solid fa-calendar-plus"></i></a></div>`:""}\n            </div>`)}):(allContest.forEach(t=>{add_to_calendar="https://calendar.google.com/event?action=TEMPLATE&dates="+t.start_time+"/"+t.end_time+"&text="+t.name+"&location="+t.url,add_to_calendar=formatCalendarUrl(add_to_calendar),contestList.append(`${t.site===current?`<div class="item animate__animated animate__fadeInUp" data-time="${t.duration}" data-date="${t.start_time}">\n            <div style="width:8%;box-sizing: border-box;" id="userlistdp">\n            <a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page"><img src="/images/contestIcons/${t.site.replace(" ","_").replace("::","_")}.png"></img></a>\n            </div>\n            <div style="width:35%;text-align: left;" class="question"><a href="${t.url}" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Contest Page">${t.name}</a></div>\n            <div style="width:20%">${localTimeFromUtc(t.start_time)}</div>\n            <div style="width:18%">${durationToText(t.duration)}</div>\n            ${"CODING"===t.status?'<div style="width:13%;background-color:#389810;padding:0.4rem 0rem;border-radius:10px;">Active</div>':"Yes"===t.in_24_hours?'<div style="width:13%;background-color:#1570FF;padding:0.4rem 0rem;border-radius:10px;">In Next 24Hrs</div>':'<div style="width:13%;background-color:#F97600;padding:0.4rem 0rem;border-radius:10px;">Coming up</div>'}\n            ${"BEFORE"===t.status?`<div style="width:6%;"><a style="color:#6BAAED;" data-toggle="tooltip" data-placement="top" title="Add to Calendar" href="${add_to_calendar}" target="_blank"><i class="fa-solid fa-calendar-plus"></i></a></div>`:""}\n        </div>`:""}`)}),void(0==contestList.children().length&&contestList.append('\n                <div class="empty-state">\n                    <div class="empty-state__content animate__animated animate__pulse">\n                      <div class="empty-state__icon">\n                        <img src="/images/search-result-not-found-2130361-1800925.png" alt="no-result-found">\n                      </div>\n                      <div class="empty-state__message">No contest available on this platform.</div>\n                      <div class="empty-state__help">\n                        Don\'t stop here! Look for contests on other platforms using the above menu.\n                      </div>\n                    </div>\n                </div>')))});